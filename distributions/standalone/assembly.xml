<!-- Assembly descriptor for the full Mule distribution. -->
<assembly>
    <id>full</id>
    <formats>
        <format>zip</format>
        <format>tar.gz</format>
    </formats>

    <fileSets>
        <fileSet>
            <directory>src/main/resources</directory>
            <outputDirectory></outputDirectory>
            <excludes>
                <exclude>**/IGNORE</exclude>
                <exclude>bin/**</exclude>
                <exclude>lib/boot/exec/**</exclude>
            </excludes>
        </fileSet>

        <!-- Make binary files executable. -->
        <fileSet>
            <directory>src/main/resources/bin</directory>
            <outputDirectory>bin</outputDirectory>
            <fileMode>755</fileMode>
            <includes>
                <include>launcher</include>
                <include>mule</include>
                <include>setup_local_instance.sh</include>
            </includes>
        </fileSet>
        <fileSet>
            <directory>src/main/resources/bin</directory>
            <outputDirectory>bin</outputDirectory>
            <fileMode>644</fileMode>
            <includes>
                <include>*.groovy</include>
                <include>*.bat</include>
                <include>*.conf</include>
                <include>*.txt</include>
            </includes>
        </fileSet>
        <fileSet>
            <directory>src/main/resources/lib/boot/exec</directory>
            <outputDirectory>lib/boot/exec</outputDirectory>
            <fileMode>755</fileMode>
            <excludes>
                <exclude>*.txt</exclude>
            </excludes>
            <includes>
                <include>*</include>
            </includes>
        </fileSet>
        <fileSet>
            <directory>src/main/resources/lib/boot/exec</directory>
            <outputDirectory>lib/boot/exec</outputDirectory>
            <fileMode>644</fileMode>
            <includes>
                <include>*.txt</include>
            </includes>
        </fileSet>

        <!-- Copy javadocs (the build must be run with -DperformRelease=true) -->
        <fileSet>
            <directory>../../target/site/apidocs</directory>
            <outputDirectory>docs/api</outputDirectory>
            <fileMode>0644</fileMode>
        </fileSet>

        <!-- Copy source bundle (the build must be run with -DperformRelease=true) -->
        <fileSet>
            <directory>target</directory>
            <outputDirectory>src</outputDirectory>
            <includes>
                <include>mule-*-src.zip</include>
            </includes>
        </fileSet>

    </fileSets>

    <!--
    ============================
        Libraries
    ============================
    -->

    <!-- TODO: Update to use wildcards once this issue is fixed:
   http://jira.codehaus.org/browse/MASSEMBLY-220 -->
    <dependencySets>

        <!-- Bootstrap -->
        <dependencySet>
            <outputDirectory>lib/boot</outputDirectory>
            <useStrictFiltering>true</useStrictFiltering>
            <includes>
                <!--<include>org.mule.modules:mule-module-boot</include>-->
                <include>org.mule.modules:mule-module-reboot</include>
                <include>commons-cli:commons-cli</include>
                <include>tanukisoft:wrapper</include>
                <include>org.apache.felix:org.apache.felix.framework</include>
                <include>org.osgi:org.osgi.core</include>
                <!--<include>org.slf4j:slf4j-api</include>-->
                <!--<include>org.apache.logging.log4j:log4j-api</include>-->
                <!--<include>org.apache.logging.log4j:log4j-core</include>-->
                <!--<include>org.apache.logging.log4j:log4j-slf4j-impl</include>-->
                <!--<include>org.apache.logging.log4j:log4j-1.2-api</include>-->
                <!--<include>org.apache.logging.log4j:log4j-jcl</include>-->
                <!--<include>org.apache.logging.log4j:log4j-jul</include>-->
                <!--<include>org.slf4j:jcl-over-slf4j</include>-->
                <!--<include>com.lmax:disruptor</include>-->
            </includes>
        </dependencySet>

        <!-- Mule libraries -->
        <dependencySet>
            <outputDirectory>lib/mule</outputDirectory>
            <outputFileNameMapping>${artifact.artifactId}-${artifact.baseVersion}${dashClassifier?}.${artifact.extension}</outputFileNameMapping>
            <useStrictFiltering>true</useStrictFiltering>
            <includes>
                <!-- Mule API -->
                <include>org.mule:mule-api</include>
                <!-- extensions API -->
                <include>org.mule.extensions:mule-extensions-api</include>
                <include>org.mule.extensions:mule-extensions-annotations</include>
                <!-- Core -->
                <include>org.mule:mule-core</include>
                <!-- Transports -->
                <include>org.mule.transports:mule-transport-email</include>
                <include>org.mule.transports:mule-transport-file</include>
                <include>org.mule.transports:mule-transport-http</include>
                <include>org.mule.transports:mule-transport-jdbc</include>
                <include>org.mule.transports:mule-transport-jms</include>
                <include>org.mule.transports:mule-transport-servlet</include>
                <include>org.mule.transports:mule-transport-ssl</include>
                <include>org.mule.transports:mule-transport-tcp</include>
                <include>org.mule.transports:mule-transport-vm</include>
                <!-- Modules -->
                <include>org.mule.modules:mule-module-launcher</include>
                <include>org.mule.modules:mule-module-annotations</include>
                <include>org.mule.modules:mule-module-builders</include>
                <include>org.mule.modules:mule-module-client</include>
                <include>org.mule.modules:mule-module-cxf</include>
                <include>org.mule.modules:mule-module-db</include>
                <include>org.mule.modules:mule-module-devkit-support</include>
                <include>org.mule.modules:mule-module-extensions-support</include>
                <include>org.mule.modules:mule-module-extensions-spring-support</include>
                <include>org.mule.modules:mule-module-http</include>
                <include>org.mule.modules:mule-module-jaas</include>
                <include>org.mule.modules:mule-module-jbossts</include>
                <include>org.mule.modules:mule-module-json</include>
                <include>org.mule.modules:mule-module-management</include>
                <include>org.mule.modules:mule-module-oauth</include>
                <include>org.mule.modules:mule-module-pgp</include>
                <include>org.mule.modules:mule-module-scripting</include>
                <include>org.mule.modules:mule-module-schedulers</include>
                <include>org.mule.modules:mule-module-spring-config</include>
                <include>org.mule.modules:mule-module-spring-extras</include>
                <include>org.mule.modules:mule-module-spring-security</include>
                <include>org.mule.modules:mule-module-tomcat</include>
                <include>org.mule.modules:mule-module-validation</include>
                <include>org.mule.modules:mule-module-ws</include>
                <include>org.mule.modules:mule-module-xml</include>

                <!-- Tools -->
                <include>org.mule.tools:mule-tools-anttasks</include>
                <!-- Shared libs -->
                <include>org.mule.common:mule-common</include>
                <include>org.mule.mvel:mule-mvel2</include>
            </includes>
        </dependencySet>


        <!-- Mule libraries -->
        <dependencySet>
            <outputDirectory>lib/opt</outputDirectory>
            <useStrictFiltering>true</useStrictFiltering>
            <includes>
                <include>org.codehaus.groovy:groovy-all</include>
            </includes>
        </dependencySet>
    </dependencySets>
</assembly>
